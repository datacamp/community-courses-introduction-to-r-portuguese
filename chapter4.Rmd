---
title_meta  : Capítulo 4
title       : Fatores (Factors)
description : Frequentemente, dados caem em uma quantidade limitada de categorias. Por exemplo, humanos são macho ou fêmea. Em R, dados categóricos são armazenados nos chamados fatores. Dada a importância desses fatores em análise de dados, você deve começar a aprender como criá-los, dividí-los e compará-los.

--- type:NormalExercise xp:100 skills:1 key:05273321916d99bb9c0deadf75c6834d25a47244
## O que é um factor e por que eu devo usá-lo?

Neste capítulo você irá se aventurar pelo maravilhoso mundo dos **fatores**.

O termo fator se refere a um tipo de dado estatístico usado para armazenar variáveis categóricas. A diferença entre uma variável categórica e uma variável contínua é que, uma variável categórica pode pertencer a um **número limitado de categorias**. Uma variável contínua, por sua vez, pode corresponder a um número infinito de valores.

É importante que a linguagem R saiba se está trabalhando com uma variável contínua ou categórica, já que os modelos estatísticos que você irá desenvolver no futuro tratam estes dados diferentemente. (Você vai ver depois por que isso é importante.)

Um bom exemplo de variável categórica é a variável `Gender`. Um indivíduo humano pode ser considerado "Male" (Macho) ou "Female" (Fêmea). Sendo assim, macho e fêmea são, de forma simplificada, os dois valores da variável categórica "Gender", e cada observação pode ser armazenada com o valor "Male" ou "Female".

*** =instructions
Armazene na variável `theory` o valor `"factors for categorical variables"`.

*** =hint
Simplesmente armazene o valor na variável utilizando `<-`; cuidado com letras maiúsculas.

*** =pre_exercise_code
```{r}
# no pec
```

*** =sample_code
```{r}
# Armazene na variável theory o que foi pedido!
```

*** =solution
```{r}
# Armazene na variável theory o que foi pedido!
theory <- "factors for categorical variables"
```

*** =sct
```{r}
# MC-note: ideally, we could check for commonly mistyped variable names
#test_or({
#    bad_names <- c('Theory', "teory", "thoery", "theroy", "theiory", 'gender', 'value')
#    lapply(bad_names, test_object, eval=FALSE)
#    })

msg_undef <- "Parece que você não definiu a variável `theory`."
msg_incor <- "O valor em `theory` parece incorreto. Tenha certeza de armazenar nela a string `\"factors for categorical variables\"`. Lembre-se que R é case sensitive."
msg_err <- "Tenha certeza de que você definiu `theory` corretamente, usando `<-`."

# If get error and theory is undefined, point out the error
test_or(test_error(msg_err), test_object("theory", eval = FALSE))

test_object("theory", undefined_msg = msg_undef, incorrect_msg = msg_incor)
success_msg("Bom trabalha! Pronto para começar? Continue para o próximo exercício!")
```


--- type:NormalExercise xp:100 skills:1 key:6cc21c842b075347926bb1b244782213df32e370
## O que é um factor e por que eu devo usá-lo? (2)

Para criar um fator em R, você precisa usar a função [`factor()`](http://www.rdocumentation.org/packages/base/functions/factor). A primeira coisa que você tem que fazer é criar um vetor que contenha todas as observações que pertencem a um limitado número de categorias. Por exemplo, `gender_vector` contém o sexo de 5 diferentes indivíduos:

```
gender_vector <- c("Male","Female","Female","Male","Male")
```
Está claro que há duas categorias, ou, segundo os termos em R, **'factor levels'** (Níveis de fatores): "Male" e "Female".

A função [`factor()`](http://www.rdocumentation.org/packages/base/functions/factor) vai codificar o vetor como um fator:

```
factor_gender_vector <- factor(gender_vector)
```

*** =instructions
- Converta os caracteres do vetor `gender_vector` para fator com a função `factor()` e armazene o resultado em `factor_gender_vector`.
- Exiba `factor_gender_vector` e confirme que R exibiu os níveis de fatores abaixo dos valores atuais.

*** =hint
Simplesmente use a função [`factor()`](http://www.rdocumentation.org/packages/base/functions/factor) em `gender_vector`. Dê uma olhada na descrição da tarefa, a resposta já está ali em algum lugar...

*** =pre_exercise_code
```{r}
# no pec
```

*** =sample_code
```{r}
# Gender_vector
gender_vector <- c("Male", "Female", "Female", "Male", "Male")

# Converta gender_vector para fator
factor_gender_vector <-

# Exiba factor_gender_vector

```

*** =solution
```{r}
# Gender_vector
gender_vector <- c("Male", "Female", "Female", "Male", "Male")

# Converta gender_vector para fator
factor_gender_vector <- factor(gender_vector)

# Exiba factor_gender_vector
factor_gender_vector
```

*** =sct
```{r}
test_object("factor_gender_vector",
            incorrect_msg = "Você armazenou o fator de `gender_vector` em `factor_gender_vector`?")
test_output_contains("factor_gender_vector", incorrect_msg = "Não esqueça de exibir `factor_gender_vector`!")
success_msg("Muito bom! Se você quer saber mais sobre a função `factor()`, não hesite em digitar `?factor` no console. Isso vai abrir uma página de ajuda. Continue para o próximo exercício.");
```


--- type:NormalExercise xp:100 skills:1 key:5bd4f50afc2c2dbc881e16b8ca94ca56960dff42
## O que é um factor e por que eu devo usá-lo? (3)

Há dois tipos de variáveis categóricas: a **variável categórica nominal** e a **variável categórica ordinal**.

Uma variável nominal é uma variável categórica sem valor implícito. Isso significa que é impossível dizer que 'um vale mais que o outro'. Por exemplo, imagine uma variável categórica chamada `animals_vector` com as categorias `"Elefante"`, `"Girafa"`, `"Macaco"` e `"Cavalo"`. Note que é impossível dizer que um dos animais é melhor ou pior que o outro. (Claro que alguns de vocês deve descordar ;-) ).

Em contrapartida, variáveis ordinais possuem uma ordem natural. Considere o seguinte exemplo de variável categórica chamada `temperature_vector` com as categorias: `"Baixo"`, `"Médio"` e `"Alto"`. Aqui é óbvio que `"Médio"` fica acima de `"Baixo"`, enquanto `"Alto"` fica acima de `"Médio"`.

*** =instructions
Clique em `Submit Answer` para verificar como R constroe e exibe variáveis nominais e ordinais. Não se preocupe se você não entende todo o código ainda, você vai chegar lá.

*** =hint
Apenas clique no botão `Submit Answer` e veja o console. Note que R indica a ordem dos níveis dos fatores para as variáveis categóricas ordinais.

*** =pre_exercise_code
```{r}
# no pec
```

*** =sample_code
```{r}
# Animais
animals_vector <- c("Elephant", "Giraffe", "Donkey", "Horse")
factor_animals_vector <- factor(animals_vector)
factor_animals_vector

# Temperatura
temperature_vector <- c("High", "Low", "High","Low", "Medium")
factor_temperature_vector <- factor(temperature_vector, order = TRUE, levels = c("Low", "Medium", "High"))
factor_temperature_vector
```

*** =solution
```{r}
# Animais
animals_vector <- c("Elephant", "Giraffe", "Donkey", "Horse")
factor_animals_vector <- factor(animals_vector)
factor_animals_vector

# Temperatura
temperature_vector <- c("High", "Low", "High","Low", "Medium")
factor_temperature_vector <- factor(temperature_vector, order = TRUE, levels = c("Low", "Medium", "High"))
factor_temperature_vector
```

*** =sct
```{r}
msg <- "Não altere nada no código de exemplo. Simplesmente pressione o botão Submit Answer e olhe a solução!"
test_object("animals_vector", undefined_msg = msg, incorrect_msg = msg)
test_object("temperature_vector", undefined_msg = msg, incorrect_msg = msg)
test_object("factor_animals_vector", undefined_msg = msg, incorrect_msg = msg)
test_output_contains("factor_animals_vector", incorrect_msg = msg)
test_object("factor_temperature_vector", undefined_msg = msg, incorrect_msg = msg)
test_output_contains("factor_temperature_vector", incorrect_msg = msg)
success_msg("Você consegue dizer o que está acontecendo no exercício? Incrível! Continue para o próximo exercício e saiba mais sobre os níveis de fatores.")
```


--- type:NormalExercise xp:100 skills:1 key:1aa698978d32d1a0befa4700d7da85a648e1d69e
## Níveis de fatores (Factor levels)

Quando você começa um conjunto de dados, você Frequentemente notar que ele contém fatores com específicos níveis. Contudo, algumas vezes você precisará mudar os nomes desses níveis para esclarecimento ou outras razões. R permite você fazer isso com a função [`levels()`](http://www.rdocumentation.org/packages/base/functions/levels):

```
levels(factor_vector) <- c("name1", "name2",...)
```

Um bom exemplo de ilustração são os dados brutos que são providos a você por um questionário. Uma pergunta padrão feita as pessoas que respondem a um questionário é o gênero que ele corresponde. Você deve se lembrar do exercício anterior que isso é um fator e, quando é realizado o questionamento nas ruas seus nívels geralmente são `"M"` e `"F"`.

```
survey_vector <- c("M", "F", "F", "M", "M")
```

Em seguida, quando você quer iniciar sua análise de dados, sua principal preocupação é ter um bom resumo de todas as variáveis e seus significados. Nesse ponto, você provavelmente mudará o nível dos fatores para `"Male"` e `"Female"`, ao invés de `"M"` e `"F"`, tudo isso para tornar sua vida mais fácil.

**Watch out:** A ordem que você usa para definir os níveis é importante! Se você digitar `levels(factor_survey_vector)`, você verá que ele exibe `[1] "F" "M"`. Se você não especifícar os níveis do fator quando criar o vetor, `R` irá definir definí-lo por ordem alfabética, automaticamente. Para mapear corretamente `"F"` para `"Female"`e `"M"` para `"Male"`, os níveis devem ser definidos como `c("Female", "Male")`, nesta mesma ordem.

*** =instructions
- Verifique o código que cria um fator em `survey_vector`. Você deve usar `factor_survey_vector` na próxima instrução.
- Mude os níveis de fator em `factor_survey_vector` para `c("Female", "Male")`. Lembre-se da ordem correta dos elementos do vetor.

*** =hint
Tenha atenção a ordem dos níveis de fator que você deve digitar. Dica: olhe a ordem em que os níveis são exibidos ao digitar `levels(factor_survey_vector)`.

*** =pre_exercise_code
```{r}
# no pec
survey_vector <- c("M", "F", "F", "M", "M")
factor_survey_vector <- factor(survey_vector)
```

*** =sample_code
```{r}
# Código para criar factor_survey_vector
survey_vector <- c("M", "F", "F", "M", "M")
factor_survey_vector <- factor(survey_vector)

# Especifique os níveis em factor_survey_vector
levels(factor_survey_vector) <-

factor_survey_vector
```

*** =solution
```{r}
# Código para criar factor_survey_vector
survey_vector <- c("M", "F", "F", "M", "M")
factor_survey_vector <- factor(survey_vector)

# Especifique os níveis em factor_survey_vector
levels(factor_survey_vector) <- c("Female", "Male")

factor_survey_vector
```

*** =sct
```{r}
msg = "Não altere a definição de `survey_vector`!"
test_object("survey_vector", undefined_msg = msg, incorrect_msg = msg)
msg = "Não altere ou remova o código que cria o vetor de fatores"
test_function("factor", "x", not_called_msg = msg, incorrect_msg = msg)

# MC-note: ideally would want to test assign operator `<-`, and have it highlight whole line.

# MC-note: or negate this test_student_typed, to highlight where they type this incorrect phrase
# test_student_typed('c("Male", "Female")')

test_object("factor_survey_vector", eq_condition = "equal",
            incorrect_msg = paste("Você definiu corretamente os níveis de fator para `factor_survey_vector`? Use `levels(factor_survey_vector) <- c(\"Female\", \"Male\")`. Lembre-se que R é case sensitive!"))


success_msg("Maravilha! Proceda para o próximo exercício.")
```


--- type:NormalExercise xp:100 skills:1 key:a549f13c0644ccc89cd39a10aa48706754637ed0
## Resumindo um fator

Depois deste curso, uma de suas funções favoritas em R será [`summary()`](http://www.rdocumentation.org/packages/base/functions/summary). Ela te dará um rápido resumo sobre o conteúdo da variável:

```
summary(my_var)
```

Voltando ao nosso questionário, você deve querer saber quantas respostas `"Male"` você teve em seu estudo, e quantas respostas `"Female"` também. A função [`summary()`](http://www.rdocumentation.org/packages/base/functions/summary) lhe dará as respostas para essa pergunta.

*** =instructions
Use [`summary()`](http://www.rdocumentation.org/packages/base/functions/summary) em `survey_vector` e `factor_survey_vector`. Interprete os resultados de ambos os vetores.

*** =hint
Use a função [`summary()`](http://www.rdocumentation.org/packages/base/functions/summary) em `survey_vector` e `factor_survey_vector`, simplesmente assim!

*** =pre_exercise_code
```{r}
# no pec
```

*** =sample_code
```{r}
# Crie factor_survey_vector com os níveis limpos
survey_vector <- c("M", "F", "F", "M", "M")
factor_survey_vector <- factor(survey_vector)
levels(factor_survey_vector) <- c("Female", "Male")
factor_survey_vector

# Gere um summary para survey_vector


# Gere um summary para factor_survey_vector

```

*** =solution
```{r}
# Crie factor_survey_vector com os níveis limpos
survey_vector <- c("M", "F", "F", "M", "M")
factor_survey_vector <- factor(survey_vector)
levels(factor_survey_vector) <- c("Female", "Male")
factor_survey_vector

# Gere um summary para survey_vector
summary(survey_vector)

# Gere um summary para factor_survey_vector
summary(factor_survey_vector)
```

*** =sct
```{r}
msg = "Não altere nada nas linhas iniciais que declaram `survey_vector` e `factor_survey_vector`."
test_object("survey_vector", undefined_msg = msg, incorrect_msg = msg)
test_object("factor_survey_vector", eq_condition = "equal", undefined_msg = msg, incorrect_msg = msg)
msg <- "Você usou corretamente `summary()` para gerar o summary para `%s`?"
test_output_contains("summary(survey_vector)", incorrect_msg = sprintf(msg, "survey_vector"))
test_output_contains("summary(factor_survey_vector)", incorrect_msg = sprintf(msg, "factor_survey_vector"))
success_msg("Boa! Dê uma olhada na saída do código. Devido ao fato de você identificar `\"Male\"` e `\"Female\"` como níveis de fator em `factor_survey_vector` permite a R exibir o número de elementos para cada categoria.")
```


--- type:NormalExercise xp:100 skills:1 key:90ecc160d1ebf2f75bf53f9c3843fc1632bdd0a5
## Batalha dos sexos

Em `factor_survey_vector` nós temos um fator com dois níveis: Male (Macho) e Female (Fêmea). Mas, como R avalia estes níveis uns com os outros? Em outras palavras, quem a linguagem R vai pensar que é melhor: macho ou fêmea?

*** =instructions
Leia o código no editor e clique em 'Submit Answer' para ver se machos valem mais que fêmeas.

*** =hint
Apenas clique em 'Submit Answer' e dê uma olhada na saída do código que é exibido no console.

*** =pre_exercise_code
```{r}
# no pec
```

*** =sample_code
```{r}
# Cria factor_survey_vector com os níveis limpos
survey_vector <- c("M", "F", "F", "M", "M")
factor_survey_vector <- factor(survey_vector)
levels(factor_survey_vector) <- c("Female", "Male")

# Macho
male <- factor_survey_vector[1]

# Fêmea
female <- factor_survey_vector[2]

# Batalha dos sexos: Macho é maior que Fêmea?
male > female
```

*** =solution
```{r}
# Cria factor_survey_vector com os níveis limpos
survey_vector <- c("M", "F", "F", "M", "M")
factor_survey_vector <- factor(survey_vector)
levels(factor_survey_vector) <- c("Female", "Male")

# Macho
male <- factor_survey_vector[1]

# Fêmea
female <- factor_survey_vector[2]

# Batalha dos sexos: Macho é maior que Fêmea?
male > female
```

*** =sct
```{r}
msg = "Não altere nada no código, simplesmente clique em 'Submit Answer' e olhe o resultado."
test_object("survey_vector", undefined_msg = msg, incorrect_msg = msg)
test_object("factor_survey_vector", eq_condition = "equal", undefined_msg = msg, incorrect_msg = msg)
test_object("male", undefined_msg = msg, incorrect_msg = msg)
test_object("female", undefined_msg = msg, incorrect_msg = msg)
test_output_contains("male > female", incorrect_msg = msg)
success_msg("Ufa, parece que R é neutro nessa briga? Ou talvez só queira ficar longe de problemas ;-).")
```


--- type:NormalExercise xp:100 skills:1 key:9ab0928916bf84ab225713a9a1ce40d9e322c6a0
## Fatores ordenados

Desde que `"Male"` e `"Female"` são níveis de fatores desordenados (ou nominais), R retorna uma mensagem de aviso, informando a você que o operador Maior que não é significante. Como vimos anteriormente, R atribui um valor igual para os níveis de tais fatores.

Mas esse nem sempre é o caso! Algumas vezes você irá querer lidar com fatores que tem uma ordenação natual entre suas categorias. Se este é o caso, nós devemos ter certeza que passamos estas informações para R...

Vamos supor que você está liderando um time de pesquisa de cinco analistas de dados e que você quer avaliar seu desempenho. Para fazer isso, você avalia a velocidade deles e avalia cada analista como `"slow"` (devagar), `"fast"` (rápido) ou `"insane"` (insano), além de salvar os resultados em `speed_vector`.

*** =instructions

Nesta primeira etapa, armazene em `speed_vector` um vetor com cinco entradas, uma para cada analista. Cada entrada deve conter `"slow"`, `"fast"`, ou `"insane"`. Use a lista abaixo:

- Analista 1 é fast,
- Analista 2 é slow,
- Analista 3 é slow,
- Analista 4 é fast e o
- Analista 5 é insane.

Não há necessidade de especificar esses fatores ainda.

*** =hint
Armazene em `speed_vector` um vetor contendo caracteres string, como `"fast"`, `"slow"`, etc.

*** =pre_exercise_code
```{r}
# no pec
```

*** =sample_code
```{r}
# Crie speed_vector
speed_vector <-
```

*** =solution
```{r}
# Crie speed_vector
speed_vector <- c("fast", "slow", "slow", "fast", "insane")
```

*** =sct
```{r}
test_object("speed_vector",
            incorrect_msg = "`speed_vector` deve ser um vetor com 5 entradas, uma para cada velocidade de analista avaliado. Não use letras maíusculas; R é case sensitive!")
success_msg("Bom trabalho! Continue para o próximo exercício.")
```


--- type:NormalExercise xp:100 skills:1 key:279077d10248ce03d5f972939ef8576430a16683
## Ordered factors (2)

`speed_vector` should be converted to an ordinal factor since its categories have a natural ordering. By default, the function [`factor()`](http://www.rdocumentation.org/packages/base/functions/factor) transforms `speed_vector` into an unordered factor. To create an ordered factor, you have to add two additional arguments: `ordered` and `levels`.

```
factor(some_vector,
       ordered = TRUE,
       levels = c("lev1", "lev2" ...))
```

By setting the argument `ordered` to `TRUE` in the function [`factor()`](http://www.rdocumentation.org/packages/base/functions/factor), you indicate that the factor is ordered. With the argument `levels` you give the values of the factor in the correct order.

*** =instructions
From `speed_vector`, create an ordered factor vector: `factor_speed_vector`. Set `ordered` to `TRUE`, and set `levels` to `c("slow", "fast", "insane")`.

*** =hint
Use the function [`factor()`](http://www.rdocumentation.org/packages/base/functions/factor) to create `factor_speed_vector` based on `speed_character_vector`. The argument `ordered` should be set to `TRUE` since there is a natural ordering. Also, set `levels = c("slow", "fast", "insane")`.

*** =pre_exercise_code
```{r}
# no pec
```

*** =sample_code
```{r}
# Create speed_vector
speed_vector <- c("fast", "slow", "slow", "fast", "insane")

# Convert speed_vector to ordered factor vector
factor_speed_vector <-

# Print factor_speed_vector
factor_speed_vector
summary(factor_speed_vector)
```

*** =solution
```{r}
# Create speed_vector
speed_vector <- c("fast", "slow", "slow", "fast", "insane")

# Add your code below
factor_speed_vector <- factor(speed_vector, ordered = TRUE, levels = c("slow", "fast", "insane"))

# Print factor_speed_vector
factor_speed_vector
summary(factor_speed_vector)
```

*** =sct
```{r}
msg = "Do not change anything about the command that specifies the `speed_vector` variable."
test_object("speed_vector", undefined_msg = msg, incorrect_msg = msg)
test_function("factor", args = c("x", "ordered", "levels"),
              incorrect_msg = c("The first argument you pass to `factor()` should be `speed_vector`.",
                                "Make sure to set `ordered = TRUE` inside your call of `factor()`.",
                                "Make sure to set `levels = c(\"slow\", \"fast\", \"insane\")` inside your call of `factor()`."))
test_object("factor_speed_vector", eq_condition = "equal",
            incorrect_msg = "There's still something wrong with `factor_speed_vector`; make sure to only pass `speed_vector`, `ordered = TRUE` and `levels = c(\"slow\", \"fast\", \"insane\")` inside your call of `factor()`.")
success_msg("Great! Have a look at the console. It is now indicated that the Levels indeed have an order associated, with the `<` sign. Continue to the next exercise.")
```


--- type:NormalExercise xp:100 skills:1 key:db16e69805625bcfde227743a8cbc985f8482a37
## Comparing ordered factors

Having a bad day at work, 'data analyst number two' enters your office and starts complaining that 'data analyst number five' is slowing down the entire project. Since you know that 'data analyst number two' has the reputation of being a smarty-pants, you first decide to check if his statement is true.

The fact that `factor_speed_vector` is now ordered enables us to compare different elements (the data analysts in this case). You can simply do this by using the well-known operators.

*** =instructions
- Use `[2]` to select from `factor_speed_vector` the factor value for the second data analyst. Store it as `da2`.
- Use `[5]` to select the `factor_speed_vector` factor value for the fifth data analyst. Store it as `da5`.
- Check if `da2` is greater than `da5`; simply print out the result. Remember that you can use the `>` operator to check whether one element is larger than the other.

*** =hint
- To select the factor value for the third data analyst, you'd need `factor_speed_vector[3]`.
- To compare two values, you can use `>`. For example: `da3 > da4`.

*** =pre_exercise_code
```{r}
# no pec
```

*** =sample_code
```{r}
# Create factor_speed_vector
speed_vector <- c("fast", "slow", "slow", "fast", "insane")
factor_speed_vector <- factor(speed_vector, ordered = TRUE, levels = c("slow", "fast", "insane"))

# Factor value for second data analyst
da2 <-

# Factor value for fifth data analyst
da5 <-

# Is data analyst 2 faster than data analyst 5?

```

*** =solution
```{r}
# Create factor_speed_vector
speed_vector <- c("fast", "slow", "slow", "fast", "insane")
factor_speed_vector <- factor(speed_vector, ordered = TRUE, levels = c("slow", "fast", "insane"))

# Factor value for second data analyst
da2 <- factor_speed_vector[2]

# Factor value for fifth data analyst
da5 <- factor_speed_vector[5]

# Is data analyst 2 faster data analyst 5?
da2 > da5
```

*** =sct
```{r}
msg = "Do not change anything about the commands that define `speed_vector` and `factor_speed_vector`!"
test_object("speed_vector", undefined_msg = msg, incorrect_msg = msg)
test_object("factor_speed_vector", eq_condition = "equal", undefined_msg = msg, incorrect_msg = msg)

msg <- "Have you correctly selected the factor value for the %s data analyst? You can use `factor_speed_vector[%s]`."
test_object("da2", eq_condition = "equal", incorrect_msg = sprintf(msg, "second", "2"))
test_object("da5", eq_condition = "equal", incorrect_msg = sprintf(msg, "fifth", "5"))
test_output_contains("da2 > da5", incorrect_msg = "Have you correctly compared `da2` and `da5`? You can use the `>`. Simply print out the result.")

success_msg("Bellissimo! What do the result tell you? Data analyst two is complaining about the data analyst five while in fact he or she is the one slowing everything down! This concludes the chapter on factors. With a solid basis in vectors, matrices and factors, you're ready to dive into the wonderful world of data frames, a very important data structure in R!")
```



